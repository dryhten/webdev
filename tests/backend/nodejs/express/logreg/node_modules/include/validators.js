/*
 * simple module for validating stuff with REs
 */

function test_validate_email(){
    /*
     * simple tests for email validation
     */
    emails = ["jim@yahoo.com", "dasda", "kdljad@lkjda", "dsad.com",
	      "dsadal@lkdja.com", "@", "@kjdas.com"];
    emails.forEach(function(email){
	if (validate_email(email) === true){
	    console.log("email " + email + " is valid");
	} else {
	    console.log("email " + email + " is invalid");
	}
    });
}

function validate_email(email_string){
    /*
     * function that validates an e-mail address
     * RFC 5322 might be relevant when validating email addresses
     * this function uses something simpler
     *
     * email_string: string containing the email address to be validated
     *
     * returns:
     *   true: email address is valid
     *   false: email address is not valid
     *
     * RE taken from http://www.regular-expressions.info/email.html
     *   \A = beginning of string
     *   \z = end of string
     */
    let re = new RegExp(/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+/.source +
			/(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*/.source +
                        /@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+/.source +
                        /[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/.source);

    return re.test(email_string);
}

/* exports */
module.exports.validate_email = validate_email;
